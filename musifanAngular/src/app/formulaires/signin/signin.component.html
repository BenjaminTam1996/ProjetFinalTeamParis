<div class="container">
  <h3>Création d'un compte</h3>
  <form (ngSubmit)="save()" [formGroup]="form">
    <div class="form-group">
      <label>Vous êtes un :</label>
      <select class="form-control" formControlName="role">
        <option *ngFor="let enum of roles | keyvalue" [value]="enum.key">
          {{ enum.value }}
        </option>
      </select>
    </div>
    <ng-container *ngIf="form.controls['role'].value">
      <div class="form-group">
        <label>Prénom : </label>
        <input
          type="text"
          placeholder="Prénom"
          formControlName="prenom"
          class="form-control"
        />
        <div
          *ngIf="
            form.controls['prenom'].dirty && form.controls['prenom'].invalid
          "
          class="alert alert-danger"
        >
          {{ prenomErrorMessage() }}
        </div>
      </div>
      <div class="form-group">
        <label>Nom : </label>
        <input
          type="text"
          placeholder="Nom"
          formControlName="nom"
          class="form-control"
        />
        <div
          *ngIf="form.controls['nom'].dirty && form.controls['nom'].invalid"
          class="alert alert-danger"
        >
          {{ nomErrorMessage() }}
        </div>
      </div>
      <div
        class="form-group"
        *ngIf="form.controls['role'].value == 'UTILISATEUR'"
      >
        <label>pseudo : </label>
        <input
          placeholder="pseudo"
          formControlName="pseudo"
          class="form-control"
        />
        <div
          *ngIf="
            form.controls['pseudo'].dirty && form.controls['pseudo'].invalid
          "
          class="alert alert-danger"
        >
          {{ pseudoErrorMessage() }}
        </div>
      </div>
      <div class="form-group" *ngIf="form.controls['role'].value == 'ARTISTE'">
        <label>nom d'artiste : </label>
        <input
          placeholder="nom d'artiste"
          formControlName="nomArtiste"
          class="form-control"
        />
        <div
          *ngIf="
            form.controls['nomArtiste'].dirty &&
            form.controls['nomArtiste'].invalid
          "
          class="alert alert-danger"
        >
          {{ nomArtisteErrorMessage() }}
        </div>
      </div>
      <div class="form-group">
        <label>Téléphone : </label>
        <input
          type="tel"
          placeholder="Téléphone"
          formControlName="telephone"
          class="form-control"
        />
        <div
          *ngIf="
            form.controls['telephone'].dirty &&
            form.controls['telephone'].invalid
          "
          class="alert alert-danger"
        >
          {{ telephoneErrorMessage() }}
        </div>
      </div>
      <div class="form-group">
        <label>Email : </label>
        <input
          type="email"
          placeholder="Email"
          formControlName="email"
          class="form-control"
        />
        <div
          *ngIf="form.controls['email'].dirty && form.controls['email'].invalid"
          class="alert alert-danger"
        >
          {{ emailErrorMessage() }}
        </div>
      </div>
      <ng-container formGroupName="passwordGroup">
        <div class="form-group">
          <label>Mot de passe : </label>
          <input
            type="password"
            placeholder="Mot de passe"
            formControlName="password"
            class="form-control"
          />
          <div
            *ngIf="
              form.get('passwordGroup.password')!.dirty &&
              form.get('passwordGroup.password')!.invalid
            "
            class="alert alert-danger"
          >
            {{ passwordErrorMessage() }}
          </div>
        </div>
        <div class="form-group">
          <label>Répéter mot de passe : </label>
          <input
            type="password"
            placeholder="Répéter votre mot de passe"
            formControlName="confirm"
            class="form-control"
          />
          <div
            *ngIf="
              form.get('passwordGroup')!.hasError('checkNotEquals') &&
              form.get('passwordGroup.confirm')!.dirty
            "
            class="alert alert-danger"
          >
            Le mot de passe de confirmation doit être le même que le mot de
            passe ci-dessus
          </div>
        </div>
      </ng-container>
      <div class="form-group" *ngIf="form.controls['role'].value == 'ARTISTE'">
        <label>Description : </label>
        <textarea
          placeholder="Votre description"
          formControlName="description"
          class="form-control"
        ></textarea>
      </div>
    </ng-container>
    <div class="form-group">
      <button
        class="btn btn-outline-primary"
        [disabled]="
          form.controls['email'].invalid &&
          form.controls['passwordGroup'].invalid &&
          form.controls['telephone'].invalid &&
          form.controls['prenom'].invalid &&
          form.controls['nom'].invalid &&
          form.controls['nomArtiste'].invalid
        "
      >
        Créer un compte
      </button>
      <a
        [routerLink]="['/accueil']"
        routerLinkActive="active"
        class="btn btn-outline-warning"
        >annuler</a
      >
    </div>
  </form>
</div>
